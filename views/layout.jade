!!! 5
html(lang="en")
  head
    meta(name="viewport",content="initial-scale=1.0, user-scalable=no")
    style(type="text/css")
            html { height: 100% }
            body { height: 100%; margin: 0; padding: 0 }
            #messages { height: 100px; margin: 0; padding: 0; background-color:blue; }
            #map_canvas { height: 80% }
    script(src='http://code.jquery.com/jquery-1.6.1.min.js')
    script(type="text/javascript",
            src="http://maps.googleapis.com/maps/api/js?key=AIzaSyABQ7KzpYoVRa9eM63geCVFoBz74XajLyg&sensor=false")
    script(type="text/javascript", src="http://localhost:3000/socket.io/socket.io.js")

    script
        var lat="";
        var lon="";
        var indexcord=0;
        var neighborhoods=[];

        var socket = io.connect('http://localhost:3000');
        socket.on('cord', function (cord) {
            initialize(indexcord,cord);
            indexcord++;
        });


        var map;
        var contentString;

        var markers = [];
        var iterator = 0;

        function initializeMap(){
            var myOptions = {
                zoom: 6,
                center:  new google.maps.LatLng(41.87194,12.56738),
                mapTypeId: google.maps.MapTypeId.ROADMAP
            }
            map =  new google.maps.Map(document.getElementById("map_canvas"), myOptions);
        }
        function initialize (i,cord){
            neighborhoods[i] = cord ;
            if(i==0){

                initializeMap();
                iterator = 0;
            }
            else{

            }
            function drop() {
                for (var z = 0; z < neighborhoods.length; z++) {
                    setTimeout(function() {
                        addMarker();
                    }, i * 200);
                }
            }

            function addMarker() {
                markers.push(new google.maps.Marker({
                    position: new google.maps.LatLng(neighborhoods[iterator][0],neighborhoods[iterator][1]),
                    map: map,
                    draggable: false,
                    animation: google.maps.Animation.DROP

                }));
                iterator++;
            }
            drop();


        }




  body()

        #map_canvas(style="width:100%; height:100%")